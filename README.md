# PMLM
PMLM: Enhanced Breast Nodule Diagnosis through Parallel Multimodal Representations and Large Language Models

(PMLM, Personalized Multimodal Language Model).

### Notes

* "pre-training.py": Model for ptr-training. 
* "PMLM_train_and_test.py": Model for generating a breast ultrasound report description and diagnosis.
* "dataprocess.py": File used for processing hospital data.

### Requirements:

* transformers>=4.41.2
* datasets>=2.16.0
* accelerate>=0.30.1
* peft>=0.11.1
* trl>=0.8.6
* gradio>=4.0.0
* scipy
* einops
* sentencepiece
* tiktoken
* protobuf
* uvicorn
* pydantic
* fastapi
* sse-starlette
* fire
* packaging
* pyyaml

### Pre-training
* Framework
![image](/Figure/Arch.png)
Note: For breast nodule diagnosis, we aim to fully mine the information of both modalities, image, and text, and perform multimodal feature fusion through three parallel modules to improve the accuracy of diagnosis. We propose a deep learning model architecture, PMLM, containing three parallel modules. The proposed method consists of three main modules: (1) unimodal learner for image, (2) unimodal learner for text, and (3) multimodal learner.

### Case analysis
* case analysis
![image](/Figure/case1.png)
![image](/Figure/case2.png)
Note: This study aims to assess the risk of breast lesions being benign or malignant by generating detailed textual descriptions and inferring diagnostic results. The reports generated by the doctor and the model show a high degree of consistency in structure and descriptive detail, especially when describing malignant tumours, which can all record important features such as the location, size and invasiveness of the lump in detail. Although the model is able to capture basic imaging features, the lack of pathological data limits its diagnostic reasoning ability for complex lesions, for example, it fails to accurately reflect clinical details such as cortical thickening of lymph nodes and significant vascular signals. Similarly, in the analysis of benign lesions, the model was able to capture the regular shape of the nodules, smooth edges and faint vascular signals, and provide accurate size measurements, but its diagnostic reasoning ability was still limited. This case study demonstrates the effectiveness and limitations of the model in generating reports on malignant and benign tumours. Future research should focus on the integration of multimodal data to improve diagnostic accuracy and the clinical interpretability of reports.	


### Citation
If this work is helpful for you, please cite our paper as follows:

```

```
[DOI]()

### Contact details
If you have any questions please contact us. 

Email: mail@patrickpang.net  (Patrick Cheong-Iao Pang); taotanjs@gmail.com (Tao Tan); P2212871@mpu.edu.mo (Dashun Zheng)

